Testing model_name: opt_125m, task_id: causalLM
PATH CHECK: ['/home/yl_code/meta_zo2/zo2/test/mezo_sgd/hf_opt', '/home/vipuser/miniconda3/envs/zo2/lib/python311.zip', '/home/vipuser/miniconda3/envs/zo2/lib/python3.11', '/home/vipuser/miniconda3/envs/zo2/lib/python3.11/lib-dynload', '/home/vipuser/miniconda3/envs/zo2/lib/python3.11/site-packages', '/home/yl_code/meta_zo2/zo2']
cpu
å¼€å§‹cpuå†…å­˜ï¼š427.90234375
Transformer blocks [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11] will be offloaded to cpu
model size: 0.15 B
  0%|          | 0/3 [00:00<?, ?it/s]                                       0%|          | 0/3 [00:00<?, ?it/s]                                       0%|          | 0/3 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:00<00:01,  1.11it/s]                                              33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:00<00:01,  1.11it/s]                                              33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:00<00:01,  1.11it/s]                                              33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:01<00:01,  1.11it/s]                                              33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:01<00:01,  1.11it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:01<00:00,  3.44it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:01<00:00,  2.84it/s]
æµ‹è¯•ç‚¹1: 158357504
æµ‹è¯•ç‚¹2: 397432832
æµ‹è¯•ç‚¹4: 397432832
1æµ‹è¯•ç‚¹çš„7: 397432832
1çš„æµ‹è¯•ç‚¹8: 635094528
2æµ‹è¯•ç‚¹çš„7: 635094528
2çš„æµ‹è¯•ç‚¹8: 635094528
3æµ‹è¯•ç‚¹çš„7: 635094528
3çš„æµ‹è¯•ç‚¹8: 636012032
4æµ‹è¯•ç‚¹çš„7: 636012032
4çš„æµ‹è¯•ç‚¹8: 636012032
5æµ‹è¯•ç‚¹çš„7: 636012032
5çš„æµ‹è¯•ç‚¹8: 636012032
6æµ‹è¯•ç‚¹çš„7: 636012032
6çš„æµ‹è¯•ç‚¹8: 636012032
7æµ‹è¯•ç‚¹çš„7: 636012032
7çš„æµ‹è¯•ç‚¹8: 636012032
8æµ‹è¯•ç‚¹çš„7: 636012032
8çš„æµ‹è¯•ç‚¹8: 636012032
9æµ‹è¯•ç‚¹çš„7: 636012032
9çš„æµ‹è¯•ç‚¹8: 636012032
10æµ‹è¯•ç‚¹çš„7: 636012032
10çš„æµ‹è¯•ç‚¹8: 636012032
11æµ‹è¯•ç‚¹çš„7: 636012032
11çš„æµ‹è¯•ç‚¹8: 636012032
æµ‹è¯•ç‚¹5: 636012032
æµ‹è¯•ç‚¹6: 636012032
æµ‹è¯•ç‚¹3: 636012032
PyTorch Process Peak GPU Memory after iteration 1: 779.90 MB
Peak CPU Memory after iteration 1: 1300.55 MB
æµ‹è¯•ç‚¹1: 817780736
æµ‹è¯•ç‚¹2: 817780736
æµ‹è¯•ç‚¹4: 817780736
1æµ‹è¯•ç‚¹çš„7: 817780736
1çš„æµ‹è¯•ç‚¹8: 817780736
2æµ‹è¯•ç‚¹çš„7: 817780736
2çš„æµ‹è¯•ç‚¹8: 817780736
3æµ‹è¯•ç‚¹çš„7: 817780736
3çš„æµ‹è¯•ç‚¹8: 817780736
4æµ‹è¯•ç‚¹çš„7: 817780736
4çš„æµ‹è¯•ç‚¹8: 817780736
5æµ‹è¯•ç‚¹çš„7: 817780736
5çš„æµ‹è¯•ç‚¹8: 817780736
6æµ‹è¯•ç‚¹çš„7: 817780736
6çš„æµ‹è¯•ç‚¹8: 817780736
7æµ‹è¯•ç‚¹çš„7: 817780736
7çš„æµ‹è¯•ç‚¹8: 817780736
8æµ‹è¯•ç‚¹çš„7: 817780736
8çš„æµ‹è¯•ç‚¹8: 817780736
9æµ‹è¯•ç‚¹çš„7: 817780736
9çš„æµ‹è¯•ç‚¹8: 817780736
10æµ‹è¯•ç‚¹çš„7: 817780736
10çš„æµ‹è¯•ç‚¹8: 817780736
11æµ‹è¯•ç‚¹çš„7: 817780736
11çš„æµ‹è¯•ç‚¹8: 817780736
æµ‹è¯•ç‚¹5: 817780736
æµ‹è¯•ç‚¹6: 817780736
æµ‹è¯•ç‚¹3: 817780736
PyTorch Process Peak GPU Memory after iteration 2: 779.90 MB
Peak CPU Memory after iteration 2: 1300.68 MB
æµ‹è¯•ç‚¹1: 817780736
æµ‹è¯•ç‚¹2: 817780736
æµ‹è¯•ç‚¹4: 817780736
1æµ‹è¯•ç‚¹çš„7: 817780736
1çš„æµ‹è¯•ç‚¹8: 817780736
2æµ‹è¯•ç‚¹çš„7: 817780736
2çš„æµ‹è¯•ç‚¹8: 817780736
3æµ‹è¯•ç‚¹çš„7: 817780736
3çš„æµ‹è¯•ç‚¹8: 817780736
4æµ‹è¯•ç‚¹çš„7: 817780736
4çš„æµ‹è¯•ç‚¹8: 817780736
5æµ‹è¯•ç‚¹çš„7: 817780736
5çš„æµ‹è¯•ç‚¹8: 817780736
6æµ‹è¯•ç‚¹çš„7: 817780736
6çš„æµ‹è¯•ç‚¹8: 817780736
7æµ‹è¯•ç‚¹çš„7: 817780736
7çš„æµ‹è¯•ç‚¹8: 817780736
8æµ‹è¯•ç‚¹çš„7: 817780736
8çš„æµ‹è¯•ç‚¹8: 817780736
9æµ‹è¯•ç‚¹çš„7: 817780736
9çš„æµ‹è¯•ç‚¹8: 817780736
10æµ‹è¯•ç‚¹çš„7: 817780736
10çš„æµ‹è¯•ç‚¹8: 817780736
11æµ‹è¯•ç‚¹çš„7: 817780736
11çš„æµ‹è¯•ç‚¹8: 817780736
æµ‹è¯•ç‚¹5: 817780736
æµ‹è¯•ç‚¹6: 817780736
æµ‹è¯•ç‚¹3: 817780736
PyTorch Process Peak GPU Memory after iteration 3: 779.90 MB
Peak CPU Memory after iteration 3: 1300.68 MB
Recording Peak GPU and CPU Memory usage...
Model: opt_125m, Task: causalLM
ZO2 peak GPU memory: [0;32miteration MB[0m
ZO2 peak CPU memory: [0;32m1300.68 MB[0m
